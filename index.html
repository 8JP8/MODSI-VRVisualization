<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MODSiVR - VR Data Visualization</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="modsi-logo.svg">
    <link rel="shortcut icon" href="public/favicon.ico">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="MODSiVR - VR Data Visualization" />
    <meta property="og:description" content="Immersive VR data visualization platform using A-Frame and BabiaXR for interactive 3D charts and analytics" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://i.postimg.cc/MHXbGFv3/modsi.png" />
    <meta property="og:url" content="https://github.com/your-username/your-repo-name" />
    <meta property="og:site_name" content="MODSiVR" />
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="MODSiVR - VR Data Visualization" />
    <meta name="twitter:description" content="Immersive VR data visualization platform using A-Frame and BabiaXR for interactive 3D charts and analytics" />
    <meta name="twitter:image" content="https://i.postimg.cc/MHXbGFv3/modsi.png" />
    
    <!-- Additional Meta Tags -->
    <meta name="description" content="MODSiVR - Immersive VR data visualization platform using A-Frame and BabiaXR for interactive 3D charts and analytics">
    <meta name="keywords" content="VR, data visualization, A-Frame, BabiaXR, 3D charts, immersive analytics, virtual reality">
    <meta name="author" content="MODSiVR Team">

    <!-- A-Frame Core -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    
    <!-- A-Frame AR Component - Essential for AR functionality -->
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.5/aframe/build/aframe-ar.min.js"></script>
    
    <!-- A-Frame Extras -->
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v7.2.0/dist/aframe-extras.min.js"></script>
    
    <!-- Environment Component -->
    <script src="https://unpkg.com/aframe-environment-component@1.3.3/dist/aframe-environment-component.min.js"></script>
    
    <!-- Text Geometry -->
    <script src="https://unpkg.com/aframe-text-geometry-component@0.5.1/dist/aframe-text-geometry-component.min.js"></script>
    
    <!-- Babia Components -->
    <script src="https://cdn.jsdelivr.net/gh/babiaxr/aframe-babia-components@master/dist/aframe-babia-components.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/babiaxr/aframe-babia-ui@master/dist/aframe-babia-ui.min.js"></script>
    
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    <script src="scripts/main.js"></script>~
    
    <!-- Loading Overlay -->
    <div class="loading-overlay hidden" id="loadingOverlay">
        <div class="loading-content">
            <h1 class="loading-title">MODSiVR</h1>
            <div class="loading-spinner"></div>
            <p class="loading-text">A carregar dados da sala <span id="currentRoomDisplayLoading"></span>.</p>
            <p class="loading-text" id="roomInfo" style="font-size: 0.9rem; opacity: 0.7;"></p>
        </div>
    </div>

    <!-- Error Overlay -->
    <div class="error-overlay" id="errorOverlay">
        <div class="error-content">
            <h1 class="error-title">Erro</h1>
            <p class="error-text" id="errorMessage">Falha ao carregar os dados da sala</p>
            <button class="retry-btn" onclick="retryConnection()">Tentar Novamente</button>
            <button class="retry-btn" id="closeErrorAndEnterBtn" style="margin-top: 10px; background-color: #546e7a;">Entrar no Ambiente</button>
        </div>
    </div>

    <!-- AR Mode Instructions -->
    <div class="ar-instructions hidden" id="arInstructions">
        <div class="ar-content">
            <h3>Modo Realidade Aumentada</h3>
            <p>Aponte a câmara para uma superfície plana para ver os gráficos no mundo real.</p>
            <button class="ar-close-btn" id="closeArInstructions">Entendi</button>
        </div>
    </div>

    <a-scene 
        background="color: #ECECEC" 
        vr-mode-ui="enabled: true" 
        ar-mode-ui="enabled: true"
        arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;"
        renderer="logarithmic-depth-buffer: true; precision: medium;"
        embedded
        id="scene">
        
        <!-- Sky (will be hidden in AR mode) -->
        <a-sky color="#ECECEC" id="sky"></a-sky>
        
        <!-- Environment (will be hidden in AR mode) -->
        <a-entity environment="preset: default; groundColor: #445; groundTexture: walk;" id="environment"></a-entity>
        
        <a-assets>
            <a-asset-item id="optimerBoldFont" src="https://rawgit.com/mrdoob/three.js/dev/examples/fonts/optimer_bold.typeface.json"></a-asset-item>
        </a-assets>

        <!-- AR Marker (invisible but helps with positioning) -->
        <a-marker 
            preset="hiro" 
            id="arMarker"
            visible="false">
            <!-- Charts will be positioned relative to this marker in AR mode -->
        </a-marker>

        <!-- Ponto de inserção de gráficos -->
        <a-entity id="charts-root"></a-entity>

        <!-- Câmera VR/Desktop -->
        <a-entity 
            id="vrCamera"
            movement-controls="fly: true" 
            position="-3 5 20">
            <a-entity camera position="0 0 0" look-controls></a-entity>
            <a-entity cursor="rayOrigin:mouse" raycaster></a-entity>
            <a-entity laser-controls="hand: right"></a-entity>
        </a-entity>

        <!-- Câmera AR (will be activated in AR mode) -->
        <a-camera 
            id="arCamera"
            position="0 0 0"
            visible="false">
        </a-camera>
    </a-scene>

    <!-- Room Selector UI -->
    <div class="room-selector hidden" id="roomSelector">
        <button class="minimize-btn" id="minimizeBtn">−</button>
        <div class="room-content">
            <h3>
                <svg class="room-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                </svg>
                Seletor de Sala
            </h3>
            <div class="room-input-group">
                <input type="text" class="room-input" id="roomInput" placeholder="Código da sala (ex: LD5RU)" maxlength="10">
                <button class="room-btn" id="connectBtn">Conectar</button>
            </div>
            <div class="room-status" id="roomStatus" style="display: none;"></div>
        </div>
        <div class="collapsed-indicator" id="collapsedRoomInfo">Room: N/A</div>
    </div>
</body>
</html>
